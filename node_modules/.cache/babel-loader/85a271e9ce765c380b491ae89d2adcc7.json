{"ast":null,"code":"import _slicedToArray from\"/Users/jeongnayeong/Desktop/2021_KHU_dicon_/outsourcing_2021_KHU_dicon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import storage from\"../firebase/firebase-manager\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function UploadProfile(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),url=_useState4[0],setUrl=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),clicked=_useState8[0],setClicked=_useState8[1];var directory=props.directory;var teamName=props.teamName;var handleChange=function handleChange(e){if(e.target.files[0]){setImage(e.target.files[0]);}};var handleUpload=function handleUpload(){setClicked(true);var uploadTask=storage.ref(\"images/\".concat(teamName,\"/\").concat(directory,\"/profile/\").concat(image.name)).put(image);uploadTask.on(\"state_changed\",function(snapshot){var progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){console.log(error);},function(){storage.ref(\"images/\".concat(teamName,\"/\").concat(directory,\"/profile\")).child(image.name).getDownloadURL().then(function(url){setUrl(url);console.log(\"Profile url : \",url);props.getImgUrl(url);// if (url != '') {GetProfileImage(url);}\n});});};// console.log(\"image : \", image);\n// console.log(\"url : \", url);\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"progress\",{value:progress,max:\"100\"}),/*#__PURE__*/_jsx(\"br\",{}),props.getImgUrl,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(\"button\",{onClick:clicked?null:handleUpload,children:\"Upload\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{src:url||\"http://via.placeholde.com/300\",alt:\"profile\",style:{height:\"50px\"}}),/*#__PURE__*/_jsx(\"br\",{})]});}","map":{"version":3,"sources":["/Users/jeongnayeong/Desktop/2021_KHU_dicon_/outsourcing_2021_KHU_dicon/src/components/post/uploadProfile.js"],"names":["React","useState","storage","UploadProfile","props","image","setImage","url","setUrl","progress","setProgress","clicked","setClicked","directory","teamName","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","child","getDownloadURL","then","getImgUrl","height"],"mappings":"6LAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,KAA8B,OAA9B,CACA,MAAOC,CAAAA,OAAP,KAAoB,8BAApB,C,6IAEA,cAAe,SAASC,CAAAA,aAAT,CAAuBC,KAAvB,CAA8B,eACfH,QAAQ,EADO,wCAClCI,KADkC,eAC3BC,QAD2B,8BAEnBL,QAAQ,EAFW,yCAElCM,GAFkC,eAE7BC,MAF6B,8BAGTP,QAAQ,CAAC,CAAD,CAHC,yCAGlCQ,QAHkC,eAGxBC,WAHwB,8BAIXT,QAAQ,CAAC,KAAD,CAJG,yCAIlCU,OAJkC,eAIzBC,UAJyB,eAMzC,GAAMC,CAAAA,SAAS,CAAGT,KAAK,CAACS,SAAxB,CACA,GAAMC,CAAAA,QAAQ,CAAGV,KAAK,CAACU,QAAvB,CAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CACxB,GAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,CAAuB,CACnBZ,QAAQ,CAACU,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CACH,CACJ,CAJD,CAMA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvBP,UAAU,CAAC,IAAD,CAAV,CACA,GAAMQ,CAAAA,UAAU,CAAGlB,OAAO,CAACmB,GAAR,kBAAsBP,QAAtB,aAAkCD,SAAlC,qBAAuDR,KAAK,CAACiB,IAA7D,GAAqEC,GAArE,CAAyElB,KAAzE,CAAnB,CACAe,UAAU,CAACI,EAAX,CACI,eADJ,CAEI,SAAAC,QAAQ,CAAI,CACR,GAAMhB,CAAAA,QAAQ,CAAGiB,IAAI,CAACC,KAAL,CACZF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAoD,GADvC,CAAjB,CAGAnB,WAAW,CAACD,QAAD,CAAX,CACH,CAPL,CAQI,SAAAqB,KAAK,CAAI,CACLC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACH,CAVL,CAWI,UAAM,CACF5B,OAAO,CACFmB,GADL,kBACmBP,QADnB,aAC+BD,SAD/B,cAEKoB,KAFL,CAEW5B,KAAK,CAACiB,IAFjB,EAGKY,cAHL,GAIKC,IAJL,CAIU,SAAC5B,GAAD,CAAS,CACXC,MAAM,CAACD,GAAD,CAAN,CACAwB,OAAO,CAACC,GAAR,CAAY,gBAAZ,CAA8BzB,GAA9B,EAEAH,KAAK,CAACgC,SAAN,CAAgB7B,GAAhB,EACA;AACH,CAVL,EAWH,CAvBL,EAyBH,CA5BD,CA6BA;AACA;AAEA,mBACI,wCACI,iBAAU,KAAK,CAAEE,QAAjB,CAA2B,GAAG,CAAC,KAA/B,EADJ,cAEI,aAFJ,CAGKL,KAAK,CAACgC,SAHX,cAKI,aALJ,cAMI,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAErB,YAA7B,EANJ,cAOI,eAAQ,OAAO,CAAEJ,OAAO,CAAG,IAAH,CAASQ,YAAjC,oBAPJ,cAQI,aARJ,cASI,YACS,GAAG,CAAEZ,GAAG,EAAI,+BADrB,CAES,GAAG,CAAC,SAFb,CAGS,KAAK,CAAE,CAAC8B,MAAM,CAAE,MAAT,CAHhB,EATJ,cAcI,aAdJ,GADJ,CAkBH","sourcesContent":["import React, {useState} from \"react\";\nimport storage from \"../firebase/firebase-manager\";\n\nexport default function UploadProfile(props) {\n    const [image, setImage] = useState();\n    const [url, setUrl] = useState();\n    const [progress, setProgress] = useState(0);\n    const [clicked, setClicked] = useState(false);\n\n    const directory = props.directory;\n    const teamName = props.teamName;\n\n    const handleChange = (e) => {\n        if (e.target.files[0]) {\n            setImage(e.target.files[0]);\n        }\n    };\n\n    const handleUpload = () => {\n        setClicked(true);\n        const uploadTask = storage.ref(`images/${teamName}/${directory}/profile/${image.name}`).put(image);\n        uploadTask.on(\n            \"state_changed\",\n            snapshot => {\n                const progress = Math.round(\n                    (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n                );\n                setProgress(progress);\n            },\n            error => {\n                console.log(error);\n            },\n            () => {\n                storage\n                    .ref(`images/${teamName}/${directory}/profile`)\n                    .child(image.name)\n                    .getDownloadURL()\n                    .then((url) => {\n                        setUrl(url);\n                        console.log(\"Profile url : \", url);\n\n                        props.getImgUrl(url);\n                        // if (url != '') {GetProfileImage(url);}\n                    })\n            }\n        );\n    }\n    // console.log(\"image : \", image);\n    // console.log(\"url : \", url);\n\n    return(\n        <>\n            <progress value={progress} max=\"100\"/>\n            <br/>\n            {props.getImgUrl}\n            {/*<input onChange={handleChangeDirectory} placeholder=\"저장 폴더 이름\"/>*/}\n            <br/>\n            <input type=\"file\" onChange={handleChange}/>\n            <button onClick={clicked ? null: handleUpload}>Upload</button>\n            <br/>\n            <img\n                     src={url || \"http://via.placeholde.com/300\"}\n                     alt=\"profile\"\n                     style={{height: \"50px\"}}\n            />\n            <br/>\n        </>\n    )\n}"]},"metadata":{},"sourceType":"module"}